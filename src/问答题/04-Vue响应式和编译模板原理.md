# Vue响应式和编译模板原理

## 响应

Vue2使用了Object.defineProperty，Vue3使用了Proxy。

Vue2的响应式，是将传入的所有data属性都变成响应式，然后首次生成一个watcher实例，将后序解析过程中，访问的所有data中的属性全部加到一个deep实例中，当我们改变值的时候，只需要将deep里面的所有的watcher给更新掉，watcher里面又有对应的render函数，这个过程中，会有一个调度器，将多次执行的render合并成一次执行，取最终的数据。

Vue3的响应式，利用了Proxy的特性，不需要首次将所有的属性都变成响应式对象，省去了首次和后序每次更新属性的递归遍历。同时访问到对应的属性就将对应的属性变成响应式对象。

Vue3可以监听到属性的阐述，还有in操作符进行拦截。

Vue2使用的是正则表达式进行匹配。根据匹配的不同创建不同的元素。
Vue3使用的是AST语法树解析，然后通过解析的AST进行转化成不同的DOM，这个过程因为每个结点都能更加细致的访问，就可以添加上很多的标签表示不同的结点的作用。